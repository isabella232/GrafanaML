/*! For license information please see module.js.LICENSE.txt */
define(["@grafana/data","react","@grafana/ui","@grafana/runtime","lodash"],(function(e,t,r,n,a){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r(r.s=7)}([function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return a})),r.d(t,"__assign",(function(){return i})),r.d(t,"__rest",(function(){return o})),r.d(t,"__decorate",(function(){return s})),r.d(t,"__param",(function(){return u})),r.d(t,"__metadata",(function(){return l})),r.d(t,"__awaiter",(function(){return c})),r.d(t,"__generator",(function(){return d})),r.d(t,"__createBinding",(function(){return p})),r.d(t,"__exportStar",(function(){return f})),r.d(t,"__values",(function(){return h})),r.d(t,"__read",(function(){return m})),r.d(t,"__spread",(function(){return v})),r.d(t,"__spreadArrays",(function(){return g})),r.d(t,"__await",(function(){return y})),r.d(t,"__asyncGenerator",(function(){return _})),r.d(t,"__asyncDelegator",(function(){return b})),r.d(t,"__asyncValues",(function(){return E})),r.d(t,"__makeTemplateObject",(function(){return w})),r.d(t,"__importStar",(function(){return S})),r.d(t,"__importDefault",(function(){return T})),r.d(t,"__classPrivateFieldGet",(function(){return O})),r.d(t,"__classPrivateFieldSet",(function(){return P}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function a(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function o(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}function s(e,t,r,n){var a,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(o=(i<3?a(o):i>3?a(t,r,o):a(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o}function u(e,t){return function(r,n){t(r,n,e)}}function l(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function c(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function s(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))}function d(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function p(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}function f(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||(t[r]=e[r])}function h(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function m(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return o}function v(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(m(arguments[t]));return e}function g(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),a=0;for(t=0;t<r;t++)for(var i=arguments[t],o=0,s=i.length;o<s;o++,a++)n[a]=i[o];return n}function y(e){return this instanceof y?(this.v=e,this):new y(e)}function _(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,a=r.apply(e,t||[]),i=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(e){a[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||s(e,t)}))})}function s(e,t){try{(r=a[e](t)).value instanceof y?Promise.resolve(r.value.v).then(u,l):c(i[0][2],r)}catch(e){c(i[0][3],e)}var r}function u(e){s("next",e)}function l(e){s("throw",e)}function c(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}}function b(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,a){t[n]=e[n]?function(t){return(r=!r)?{value:y(e[n](t)),done:"return"===n}:a?a(t):t}:a}}function E(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=h(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,a){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,a,(t=e[r](t)).done,t.value)}))}}}function w(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function T(e){return e&&e.__esModule?e:{default:e}}function O(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function P(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}},function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t){e.exports=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);n.__exportStar(r(9),t),n.__exportStar(r(10),t),n.__exportStar(r(11),t),n.__exportStar(r(12),t),n.__exportStar(r(13),t),n.__exportStar(r(14),t),n.__exportStar(r(15),t),n.__exportStar(r(16),t),n.__exportStar(r(17),t),n.__exportStar(r(18),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RunHistoryClient=void 0;var n=r(0),a=r(6),i=function(){function e(){}return Object.defineProperty(e,"headers",{get:function(){return new Headers({"User-Agent":"filler",Accept:"application/json, text/plain, */*"})},enumerable:!1,configurable:!0}),e.getDiscoveryUrls=function(e,t,r){return n.__awaiter(this,void 0,Promise,(function(){var i,o,s;return n.__generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,5,,6]),i=e+"/management"+t+r+"?api-version=2020-04-01",[4,a.getBackendSrv().datasourceRequest({url:i,headers:this.headers,method:"GET",requestId:Date.now().toString()})];case 1:return(o=n.sent())&&o.data.id===r?[4,a.getBackendSrv().datasourceRequest({url:o.data.properties.discoveryUrl,headers:this.headers,method:"GET",requestId:Date.now().toString()})]:[3,3];case 2:return[2,n.sent().data];case 3:throw console.warn(o),new Error(o);case 4:return[3,6];case 5:throw s=n.sent(),console.warn(s),s;case 6:return[2]}}))}))},e.fetchSubscriptions=function(e,t){return n.__awaiter(this,void 0,Promise,(function(){var r;return n.__generator(this,(function(n){switch(n.label){case 0:return r=e+"/management"+t+"/subscriptions?api-version=2019-03-01",[4,a.getBackendSrv().datasourceRequest({url:r,headers:this.headers,method:"GET",requestId:Date.now().toString()})];case 1:return[2,n.sent().data.value.map((function(e){return{value:e.subscriptionId,label:e.displayName}}))]}}))}))},e.fetchWorkspaces=function(e,t,r){return n.__awaiter(this,void 0,Promise,(function(){var i;return n.__generator(this,(function(n){switch(n.label){case 0:return i=e+"/management"+t+"/subscriptions/"+r+"/providers/Microsoft.MachineLearningServices/workspaces?api-version=2020-04-01",[4,a.getBackendSrv().datasourceRequest({url:i,headers:this.headers,method:"GET",requestId:Date.now().toString()})];case 1:return[2,n.sent().data.value.map((function(e){return{value:e.id,label:e.name}}))]}}))}))},e.fetchExperiments=function(e,t,r){return n.__awaiter(this,void 0,Promise,(function(){var i,o,s,u;return n.__generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),i=e.baseUrl+"/runhistory"+e.authMethod+"/history/v1.0/private"+e.workspace+"/experiments:query?urlSafeExperimentNamesOnly=false",o={experimentFilterParams:{},viewType:"ActiveOnly",filter:t?"(contains(Name,'"+t+"'))":"",orderBy:"LatestCreatedRunCreatedUtc desc",top:200},r&&(o.continuationToken=r),[4,a.getBackendSrv().datasourceRequest({url:i,headers:this.headers,method:"POST",requestId:Date.now().toString(),data:JSON.stringify(o)})];case 1:return s=n.sent(),[2,{experiments:s.data.value.map((function(e){return{value:e.experimentId,label:e.name}})),continuationToken:s.data.continuationToken}];case 2:throw u=n.sent(),console.warn(u),u;case 3:return[2]}}))}))},e.fetchMetrics=function(e,t,r,i){return n.__awaiter(this,void 0,Promise,(function(){var t,o,s;return n.__generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t="runIds="+i.join("&runIds="),o=e.baseUrl+"/runhistory"+e.authMethod+"/history/v2.0"+e.workspace+"/experimentids/"+r+"/metricsmeta?"+t+"&withRetries=false",[4,a.getBackendSrv().datasourceRequest({url:o,headers:this.headers,method:"GET",requestId:Date.now().toString()})];case 1:return[2,n.sent().data.result.value.filter((function(e){return"azureml.v1.scalar"==e.type})).map((function(e){return e.name}))];case 2:return s=n.sent(),console.warn(s),[2,[]];case 3:return[2]}}))}))},e.fetchRunsFromIndexService=function(e,t){return n.__awaiter(this,void 0,Promise,(function(){var r,i,o,s,u,l;return n.__generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),r=e.baseUrl+"/api"+e.authMethod+"/index/v1.0"+e.workspace+"/entities",i=[{field:"type",operator:"eq",values:["runs"]},{field:"annotations/archived",operator:"eq",values:[!1]}],t.experiments&&t.experiments.length>0&&(o=t.experiments.map((function(e){return e.value})),i.push({field:"properties/experimentId",operator:"eq",values:o})),t.listChildRuns||i.push({field:"properties/parentRunId",operator:"eq",values:[null]}),t.runFilters&&t.runFilters.forEach((function(e){e.filterProps.forEach((function(e){i.push(e)}))})),s={filters:i,order:[{field:"properties/experimentName",direction:"Asc"},{field:"properties/runNumber",direction:"Desc"}],pageSize:2e3,skip:0,includeTotalResultCount:!0},[4,a.getBackendSrv().datasourceRequest({url:r,headers:this.headers,method:"POST",requestId:Date.now().toString(),data:JSON.stringify(s)})];case 1:return u=n.sent(),[2,{runs:u.data.value.map((function(e){var t;return{label:null!==(t=e.properties.runName)&&void 0!==t?t:e.properties.experimentName+" "+e.properties.runNumber,experimentId:e.properties.experimentId,value:e.properties.runId}})),continuationToken:u.data.continuationToken}];case 2:return l=n.sent(),console.warn(l),[2,{runs:[],continuationToken:void 0}];case 3:return[2]}}))}))},e.fetchData=function(e,t,r){return n.__awaiter(this,void 0,Promise,(function(){var i,o;return n.__generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),i=e.baseUrl+"/runhistory"+e.authMethod+"/metric/v2.0"+e.workspace+"/runs/"+r+"/sample",[4,a.getBackendSrv().datasourceRequest({url:i,headers:this.headers,method:"POST",requestId:Date.now().toString(),data:JSON.stringify({metricName:t.metricName})})];case 1:return[2,n.sent().data.value];case 2:throw o=n.sent(),console.warn(o),o;case 3:return[2]}}))}))},e.getNewToken=function(e){return n.__awaiter(this,void 0,Promise,(function(){var t,r,i;return n.__generator(this,(function(n){switch(n.label){case 0:t=e.instanceSettings.jsonData.targetRuns[0],n.label=1;case 1:return n.trys.push([1,3,,4]),r=e.baseUrl+"/runhistory"+e.authMethod+"/history/v1.0"+e.workspace+"/experimentids/"+t.experiment+"/runs/"+t.run+"/token",[4,a.getBackendSrv().datasourceRequest({url:r,headers:this.headers,method:"GET",requestId:Date.now().toString()})];case 2:return[2,n.sent().data.token];case 3:return i=n.sent(),console.warn(i),[2,""];case 4:return[2]}}))}))},e}();t.RunHistoryClient=i},function(e,t){e.exports=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.plugin=void 0;var n=r(1),a=r(8),i=r(19),o=r(20);t.plugin=new n.DataSourcePlugin(a.AzureMLDataSource).setConfigEditor(i.ConfigEditor).setQueryEditor(o.QueryEditor)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AzureMLDataSource=void 0;var n=r(0),a=r(1),i=r(5),o=r(4),s=r(6),u=function(e){function t(t){var r=e.call(this,t)||this;return r.instanceSettings=t,r.subscriptionId=t.jsonData.subscriptionId,r.authMethod=t.jsonData.authMethod,r.baseUrl=t.url||"",r.workspace=t.jsonData.workspace,r.targetRuns,"runtoken"===t.jsonData.datasourceType&&t.jsonData.targetRuns&&t.jsonData.targetRuns.length>0&&(r.targetRuns=t.jsonData.targetRuns,r.refreshToken(),setInterval((function(){return n.__awaiter(r,void 0,void 0,(function(){return n.__generator(this,(function(e){switch(e.label){case 0:return[4,this.refreshToken()];case 1:return e.sent(),[2]}}))}))}),18e5)),r}return n.__extends(t,e),t.prototype.refreshToken=function(){return n.__awaiter(this,void 0,void 0,(function(){var e,t;return n.__generator(this,(function(r){switch(r.label){case 0:return[4,i.RunHistoryClient.getNewToken(this)];case 1:return e=r.sent(),[4,s.getBackendSrv().get("/api/datasources/"+this.instanceSettings.id)];case 2:return(t=r.sent()).secureJsonData={authToken:e},s.getBackendSrv().put("/api/datasources/"+this.instanceSettings.id,t),[2]}}))}))},t.prototype.hasRequiredParameters=function(e){return!!e.runs&&!!e.metricName},t.prototype.query=function(e){return n.__awaiter(this,void 0,Promise,(function(){var t,r,o=this;return n.__generator(this,(function(s){switch(s.label){case 0:return[4,Promise.all(e.targets.map((function(e){return n.__awaiter(o,void 0,void 0,(function(){var t=this;return n.__generator(this,(function(r){switch(r.label){case 0:return this.hasRequiredParameters(e)?[4,Promise.all(e.runs.map((function(r){return n.__awaiter(t,void 0,void 0,(function(){var t,o,s;return n.__generator(this,(function(n){switch(n.label){case 0:t=new a.MutableDataFrame({refId:e.refId,name:r.label,fields:[{name:"time",type:a.FieldType.time},{name:e.metricName,type:a.FieldType.number}]}),o=[],n.label=1;case 1:return n.trys.push([1,3,,4]),[4,i.RunHistoryClient.fetchData(this,e,r.value)];case 2:return o=n.sent(),[3,4];case 3:if(void 0!==(s=n.sent()).status){if(404===s.status)return[2];if(401===s.status)throw Error("Authentication failed. Please reset authentication credentials.");if(502===s.status)throw Error("Proxy request failed. Please reset the datasource.");throw s}return[3,4];case 4:return 0===o.length?[2]:(o.forEach((function(r){var n;t.add(((n={time:+new Date(r.createdUtc)})[e.metricName]=r.data[e.metricName],n))})),[2,t])}}))}))})))]:[2,[]];case 1:return[2,r.sent()]}}))}))})))];case 1:return t=s.sent(),(r=t.flat().filter((function(e){return void 0!==e})))&&0!==r.length?[2,{data:r}]:[2,{data:[]}]}}))}))},t.prototype.testExperiment=function(e){return void 0===e&&(e=0),n.__awaiter(this,void 0,Promise,(function(){var t,r=this;return n.__generator(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,5]),[4,i.RunHistoryClient.fetchExperiments(this)];case 1:return[2,n.sent().experiments];case 2:return t=n.sent(),e>0?[4,new Promise((function(t){return setTimeout((function(){t(r.testExperiment(e-1))}),o.DATASOURCE_RETRY_TIME)}))]:[3,4];case 3:return[2,n.sent()];case 4:throw t;case 5:return[2]}}))}))},t.prototype.testDatasource=function(){return n.__awaiter(this,void 0,Promise,(function(){var e;return n.__generator(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.testExperiment(1)];case 1:return 0===t.sent().length?[2,{status:"success",message:"Updated. Workspace is empty."}]:[2,{status:"success",message:"Success"}];case 2:if(e=t.sent(),console.log(this.instanceSettings),void 0!==e.status){if(401===e.status)return[2,{status:"error",message:"Authentication failed. Reset auth credentials."}];if(e.status>=500)return[2,{status:"error",message:"Service error: "+(void 0!==e.statusText?JSON.stringify(e.statusText):"unknown")}]}return[2,{status:"error",message:"Unexpected error : "+JSON.stringify(e)}];case 3:return[2]}}))}))},t}(a.DataSourceApi);t.AzureMLDataSource=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.timePickerLabel=t.timePicker=t.horizDivForTimePicker=t.h3=t.h2=t.timePickerContainer=void 0,t.timePickerContainer={width:"50%",marginBottom:"-10px"},t.h2={fontSize:"16px",fontWeight:500,lineHeight:"1.25",maxWidth:"480px"},t.h3={fontSize:"14px",fontWeight:300,lineHeight:"1.25",maxWidth:"480px",marginTop:"5px"},t.horizDivForTimePicker={height:".25px",background:"#2a6cd1",borderTop:"#2a6cd1",textAlign:"right",margin:"0",width:"56%"},t.timePicker={marginLeft:"58%",marginTop:"-7px"},t.timePickerLabel={fontWeight:"lighter",color:"#2a6cd1"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_QUERY_RUNS=t.DATASOURCE_RETRY_TIME=t.SELECT_ALL_LABEL=t.AUTH_TOKEN_ROUTE=t.CLIENT_CREDENTIAL_ROUTE=void 0,t.CLIENT_CREDENTIAL_ROUTE="clientcred",t.AUTH_TOKEN_ROUTE="authtoken",t.SELECT_ALL_LABEL="-- Select All  --",t.DATASOURCE_RETRY_TIME=4e3,t.MAX_QUERY_RUNS=200},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";var n,a,i,o;Object.defineProperty(t,"__esModule",{value:!0}),t.propertiesOptions=t.propertyDetailsDict=t.stringOperations=t.tagOperations=t.statusValueOptions=t.runTypeValueOptions=t.dateFieldOperations=t.numericOperations=t.FilterOperations=t.RunProperties=t.PropertyType=void 0,function(e){e[e.number=0]="number",e[e.date=1]="date",e[e.string=2]="string",e[e.tag=3]="tag"}(a=t.PropertyType||(t.PropertyType={})),function(e){e.number="Run number",e.targetName="Target name",e.runType="Run type",e.status="Status",e.createdDate="Created time",e.tags="Tags",e.createdBy="Created by"}(i=t.RunProperties||(t.RunProperties={})),function(e){e.equals="eq",e.lessThan="lt",e.notEqual="ne",e.greaterThan="gt",e.lessOrEqual="le",e.greaterOrEqual="ge"}(o=t.FilterOperations||(t.FilterOperations={})),t.numericOperations=[{label:"==",value:o.equals},{label:"!=",value:o.notEqual},{label:"<",value:o.lessThan},{label:">",value:o.greaterThan},{label:"<=",value:o.lessOrEqual},{label:">=",value:o.greaterOrEqual}],t.dateFieldOperations=[{label:"After",value:o.greaterThan},{label:"On date or after",value:o.greaterOrEqual},{label:"Before",value:o.lessThan},{label:"On date or before",value:o.lessOrEqual}],t.runTypeValueOptions=[{label:"Automated ML",value:"Automated ML"},{label:"Hyperdrive",value:"Hyperdrive"},{label:"Pipeline",value:"Pipeline"},{label:"Pipeline Step",value:"Pipeline step"},{label:"Script",value:"Script"}],t.statusValueOptions=[{label:"Cancel Requested",value:"Cancel requested"},{label:"Canceled",value:"Canceled"},{label:"Completed",value:"Completed"},{label:"Failed",value:"Failed"},{label:"Finalizing",value:"Finalizing"},{label:"Not Responding",value:"Not responding"},{label:"Not Started",value:"Not started"},{label:"Preparing",value:"Preparing"},{label:"Provisioning",value:"Provisioning"},{label:"Queued",value:"Queued"},{label:"Running",value:"Running"},{label:"Starting",value:"Starting"},{label:"Succeeded",value:"Succeeded"},{label:"Timed Out",value:"Timed out"}],t.tagOperations=[{label:"key is defined",value:o.notEqual},{label:"key == value",value:o.equals}],t.stringOperations=[{label:"==",value:o.equals},{label:"!=",value:o.notEqual}],t.propertyDetailsDict=((n={})[i.number]={options:t.numericOperations,type:a.number,queryPath:"properties/runNumber"},n[i.runType]={options:t.stringOperations,type:a.string,queryPath:"properties/runType",allowedValues:t.runTypeValueOptions},n[i.targetName]={options:t.stringOperations,type:a.string,queryPath:"properties/targetName"},n[i.createdDate]={options:[t.dateFieldOperations],type:a.date,queryPath:"properties/creationContext/createdTime"},n[i.createdBy]={options:t.stringOperations,type:a.string,queryPath:"properties/creationContext/createdBy/userName"},n[i.tags]={options:t.tagOperations,type:a.tag,queryPath:"annotations/tags/"},n[i.status]={options:t.stringOperations,type:a.string,queryPath:"annotations/status",allowedValues:t.statusValueOptions},n),t.propertiesOptions=[{label:i.createdBy,value:i.createdBy},{label:i.createdDate,value:i.createdDate},{label:i.number,value:i.number},{label:i.runType,value:i.runType},{label:i.status,value:i.status},{label:i.targetName,value:i.targetName},{label:i.tags,value:i.tags}]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigEditor=void 0;var n=r(0),a=n.__importStar(r(2)),i=r(3),o=r(1),s=r(5),u=r(6),l=r(4),c=function(e){function t(t){var r=e.call(this,t)||this;return r.authOptions=[{label:"Client credentials",value:l.CLIENT_CREDENTIAL_ROUTE}],r.onAuthChange=function(e){o.updateDatasourcePluginSecureJsonDataOption(r.props,"authToken",e.target.value),r.setState({loadResourcesError:void 0})},r.onAuthRouteChange=function(e){o.updateDatasourcePluginJsonDataOption(r.props,"authMethod",e.value)},r.onClientSecretChange=function(e){o.updateDatasourcePluginSecureJsonDataOption(r.props,"clientSecret",e.target.value),r.setState({loadResourcesError:void 0})},r.onSubscriptionSelected=function(e){var t=r.props.options;r.props.onOptionsChange(n.__assign(n.__assign({},t),{jsonData:n.__assign(n.__assign({},t.jsonData),{workspace:void 0,subscriptionId:e.value})}))},r.onWorkspaceSelected=function(e){r.setState({loadingWorkspaceDetails:!0},(function(){return n.__awaiter(r,void 0,void 0,(function(){var t,r,a,i,l=this;return n.__generator(this,(function(c){switch(c.label){case 0:return[4,s.RunHistoryClient.getDiscoveryUrls("/api/datasources/proxy/"+this.props.options.id,this.props.options.jsonData.authMethod,e.value)];case 1:return t=c.sent(),r=t.history.replace("https://",""),a=t.api.replace("https://",""),i=this.props.options,this.props.onOptionsChange(n.__assign(n.__assign({},i),{jsonData:n.__assign(n.__assign({},i.jsonData),{workspace:e.value,runHistoryUrl:r,apiUrl:a})})),[4,u.getBackendSrv().put("/api/datasources/"+this.props.options.id,this.props.options).then((function(e){o.updateDatasourcePluginOption(l.props,"version",e.version)}))];case 2:return c.sent(),this.setState({loadingWorkspaceDetails:!1}),[2]}}))}))}))},r.onTenantIdChange=function(e){o.updateDatasourcePluginJsonDataOption(r.props,"tenantId",e.target.value)},r.onClientIdChange=function(e){o.updateDatasourcePluginJsonDataOption(r.props,"clientId",e.target.value)},r.hasNecessaryCredentials=function(){var e,t,n,a;if("clientcred"===r.props.options.jsonData.authMethod){if(!(null===(e=r.props.options.secureJsonFields)||void 0===e?void 0:e.clientSecret)&&!(null===(t=r.props.options.secureJsonData)||void 0===t?void 0:t.clientSecret))return!1;if(!r.props.options.jsonData.clientId||!r.props.options.jsonData.tenantId)return!1}else if(!(null===(n=r.props.options.secureJsonFields)||void 0===n?void 0:n.authToken)&&!(null===(a=r.props.options.secureJsonData)||void 0===a?void 0:a.authToken))return!1;return!0},r.loadSubscriptionsAndWorkspaces=function(){return n.__awaiter(r,void 0,void 0,(function(){return n.__generator(this,(function(e){switch(e.label){case 0:return[4,this.loadSubscriptions()];case 1:return e.sent(),this.loadWorkspaces(),[2]}}))}))},r.loadSubscriptions=function(){return n.__awaiter(r,void 0,void 0,(function(){var e=this;return n.__generator(this,(function(t){switch(t.label){case 0:return[4,u.getBackendSrv().put("/api/datasources/"+this.props.options.id,this.props.options).then((function(t){o.updateDatasourcePluginOption(e.props,"version",t.version)}))];case 1:return t.sent(),this.hasNecessaryCredentials()&&this.setState({subscriptions:void 0},(function(){return n.__awaiter(e,void 0,void 0,(function(){var e,t,r;return n.__generator(this,(function(n){switch(n.label){case 0:e="/api/datasources/proxy/"+this.props.options.id,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,s.RunHistoryClient.fetchSubscriptions(e,this.props.options.jsonData.authMethod)];case 2:return t=n.sent(),this.setState({subscriptions:t,loadResourcesError:void 0}),void 0===this.props.options.jsonData.subscriptionId&&o.updateDatasourcePluginJsonDataOption(this.props,"subscriptionId",t[0].value),[3,4];case 3:return 401===(r=n.sent()).status?this.setState({loadResourcesError:"Authorization failed, cannot load subscriptions"}):this.setState({loadResourcesError:JSON.stringify(r)}),[3,4];case 4:return[2]}}))}))})),[2]}}))}))},r.loadWorkspaces=function(){var e=r.props.options.jsonData.subscriptionId;r.hasNecessaryCredentials()&&void 0!==e&&r.setState({workspaces:void 0},(function(){return n.__awaiter(r,void 0,void 0,(function(){var t,r,a,i;return n.__generator(this,(function(n){switch(n.label){case 0:t="/api/datasources/proxy/"+this.props.options.id,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,s.RunHistoryClient.fetchWorkspaces(t,this.props.options.jsonData.authMethod,e)];case 2:return r=n.sent(),this.setState({workspaces:r,loadResourcesError:void 0}),void 0!==(a=this.props.options.jsonData.workspace)&&void 0!==r.find((function(e){return e.value===a}))||this.onWorkspaceSelected(r[0]),[3,4];case 3:return 401===(i=n.sent()).status?this.setState({loadResourcesError:"Authorization failed, cannot load workspaces",workspaces:[]}):this.setState({loadResourcesError:JSON.stringify(i),workspaces:[]}),[3,4];case 4:return[2]}}))}))}))},r.renderRunTokenPage=function(){return a.default.createElement(a.default.Fragment,null,a.default.createElement(i.Legend,null,"Azure Machine Learning Metrics"),a.default.createElement("div",null,"This data source was generated using the AzureML SDK, and can not be further configured. If the authorization has expired, it can be refreshed by re-submitting using the SDK. Additional refresh options are being developed."))},r.state={subscriptions:[],workspaces:[],loadingWorkspaceDetails:!1,loadResourcesError:void 0},r.props.options.id&&o.updateDatasourcePluginOption(r.props,"url","/api/datasources/proxy/"+r.props.options.id),r}return n.__extends(t,e),t.prototype.componentDidMount=function(){"runtoken"!==this.props.options.jsonData.datasourceType&&this.loadSubscriptionsAndWorkspaces()},t.prototype.componentDidUpdate=function(e){e.options.jsonData.subscriptionId!==this.props.options.jsonData.subscriptionId&&this.loadWorkspaces()},t.prototype.render=function(){var e,t,r=this.props.options;r.jsonData.authMethod=r.jsonData.authMethod||l.CLIENT_CREDENTIAL_ROUTE,r.secureJsonData=r.secureJsonData||{};var n=null===(e=r.secureJsonFields)||void 0===e?void 0:e.clientSecret,s=null===(t=r.secureJsonFields)||void 0===t?void 0:t.authToken,u=this.hasNecessaryCredentials();return"runtoken"===r.jsonData.datasourceType?this.renderRunTokenPage():a.default.createElement("div",null,a.default.createElement(i.Legend,null,"Azure Machine Learning Metrics"),a.default.createElement("div",{className:"gf-form-group"},"clientcred"===r.jsonData.authMethod&&a.default.createElement(a.default.Fragment,null,a.default.createElement("div",{className:"gf-form-inline"},a.default.createElement("div",{className:"gf-form"},a.default.createElement(i.InlineFormLabel,{className:"width-12"},"Directory (tenant) ID"),a.default.createElement("div",{className:"width-15"},a.default.createElement(i.Input,{className:"width-30",placeholder:"XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX",value:this.props.options.jsonData.tenantId,onChange:this.onTenantIdChange})))),a.default.createElement("div",{className:"gf-form-inline"},a.default.createElement("div",{className:"gf-form"},a.default.createElement(i.InlineFormLabel,{className:"width-12"},"Application (client) ID"),a.default.createElement("div",{className:"width-15"},a.default.createElement(i.Input,{className:"width-30",placeholder:"XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX",value:this.props.options.jsonData.clientId,onChange:this.onClientIdChange})))),a.default.createElement("div",{className:"gf-form-inline"},a.default.createElement("div",{className:"gf-form"},n?a.default.createElement("div",{className:"gf-form-inline"},a.default.createElement("div",{className:"gf-form"},a.default.createElement(i.InlineFormLabel,{className:"width-12"},"Client Secret"),a.default.createElement(i.Input,{className:"width-25",placeholder:"configured",disabled:!0,invalid:void 0!==this.state.loadResourcesError})),a.default.createElement("div",{className:"gf-form"},a.default.createElement("div",{className:"max-width-30 gf-form-inline"},a.default.createElement(i.Button,{variant:this.state.loadResourcesError?"destructive":"secondary",type:"button",onClick:o.onUpdateDatasourceResetOption(this.props,"clientSecret")},"reset")))):a.default.createElement("div",{className:"gf-form-inline"},a.default.createElement("div",{className:"gf-form"},a.default.createElement(i.InlineFormLabel,{className:"width-12"},"Client Secret"),a.default.createElement(i.Field,{className:"width-15",invalid:void 0!==this.state.loadResourcesError,error:this.state.loadResourcesError},a.default.createElement(i.Input,{className:"width-30",placeholder:"XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX",value:r.secureJsonData.clientSecret||"",onChange:this.onClientSecretChange}))))))),"authtoken"===r.jsonData.authMethod&&a.default.createElement("div",{className:"gf-form"},s?a.default.createElement("div",{className:"gf-form-inline"},a.default.createElement("div",{className:"gf-form"},a.default.createElement(i.InlineFormLabel,{className:"width-12"},"Authorization Token"),a.default.createElement(i.Input,{className:"width-25",placeholder:"configured",disabled:!0,invalid:void 0!==this.state.loadResourcesError})),a.default.createElement("div",{className:"gf-form"},a.default.createElement("div",{className:"max-width-30 gf-form-inline"},a.default.createElement(i.Button,{variant:this.state.loadResourcesError?"destructive":"secondary",type:"button",onClick:o.onUpdateDatasourceResetOption(this.props,"authToken")},"reset")))):a.default.createElement("div",{className:"gf-form-inline"},a.default.createElement("div",{className:"gf-form"},a.default.createElement(i.InlineFormLabel,{className:"width-12"},"Authorization Token"),a.default.createElement(i.Field,{className:"width-15",invalid:void 0!==this.state.loadResourcesError,error:this.state.loadResourcesError},a.default.createElement(i.Input,{className:"width-30",placeholder:"XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX",value:r.secureJsonData.authToken||"",onChange:this.onAuthChange}))))),a.default.createElement("div",{className:"gf-form-inline"},a.default.createElement("div",{className:"gf-form"},a.default.createElement(i.InlineFormLabel,{className:"width-12"},"Default Subscription"),a.default.createElement("div",{className:"width-25"},a.default.createElement(i.Select,{className:"width-30",value:r.jsonData.subscriptionId,options:this.state.subscriptions,onChange:this.onSubscriptionSelected,placeholder:"Select Subscription",isLoading:void 0===this.state.subscriptions})))),a.default.createElement("div",{className:"gf-form-inline"},a.default.createElement("div",{className:"gf-form"},a.default.createElement("div",{className:"max-width-30 gf-form-inline"},a.default.createElement(i.Button,{variant:"secondary",size:"sm",type:"button",onClick:this.loadSubscriptionsAndWorkspaces,disabled:!u},"Load Subscriptions")))),a.default.createElement("div",{className:"gf-form-inline",style:{width:300}},a.default.createElement("div",{className:"gf-form"},a.default.createElement(i.InlineFormLabel,{className:"width-12"},"Workspace"),a.default.createElement("div",{className:"width-25"},a.default.createElement(i.Select,{key:r.jsonData.subscriptionId,className:"width-30",value:r.jsonData.workspace,options:this.state.workspaces,onChange:this.onWorkspaceSelected,placeholder:"Select Workspace",isLoading:void 0===this.state.workspaces})))),this.state.loadingWorkspaceDetails&&a.default.createElement("div",{className:"gf-form-inline",style:{width:300}},a.default.createElement(i.InlineFormLabel,{className:"width-12"},"Loading details..."))))},t}(a.PureComponent);t.ConfigEditor=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QueryEditor=void 0;var n=r(0),a=n.__importDefault(r(21)),i=n.__importStar(r(2)),o=r(3),s=r(5),u=r(22),l=r(4),c=function(e){function t(r){var a=e.call(this,r)||this;return a.getLabel=function(e){return e.name},a.getValue=function(e){return e.id},a.onExperimentSelected=function(e){var r=a.props,i=r.onChange,o=r.query;-1!==e.findIndex((function(e){return e.value===t.allExperimentsKey}))?i(n.__assign(n.__assign({},o),{experiments:n.__spread(a.state.experiments)})):i(n.__assign(n.__assign({},o),{experiments:e}))},a.onFiltersUpdated=function(e){var t=a.props,r=t.onChange,i=t.query;r(n.__assign(n.__assign({},i),{runFilters:e}))},a.onListChildRunsChange=function(e){var t=a.props,r=t.onChange,i=t.query;r(n.__assign(n.__assign({},i),{listChildRuns:e}))},a.onFilterByExperimentsChange=function(e){var t=a.props,r=t.onChange,i=t.query;r(n.__assign(n.__assign({},i),{filterByExperiments:e.currentTarget.checked,experiments:e.currentTarget.checked&&i.experiments||[]}))},a.onRunSelected=function(e){var r=a.props,i=r.onChange,o=r.query;-1!==e.findIndex((function(e){return e.value===t.allRunsKey}))?i(n.__assign(n.__assign({},o),{runs:n.__spread(a.state.runs)})):i(n.__assign(n.__assign({},o),{runs:e})),a.props.query.metricName&&a.props.onRunQuery()},a.onMetricSelected=function(e){var t=a.props,r=t.onChange,i=t.query,o=t.onRunQuery;r(n.__assign(n.__assign({},i),{metricName:e.value})),o()},a.state={experiments:[],runs:[],metrics:[],showExperimentCountWarning:!1,showRunCountWarning:!1},a.loadFilteredExperiments=a.loadFilteredExperiments.bind(a),a}return n.__extends(t,e),t.prototype.componentDidMount=function(){if(void 0!==this.props.datasource.targetRuns)this.initByTargetRuns();else{var e=this.props,t=e.onChange,r=e.query;t(n.__assign(n.__assign({},r),{runs:[],experiments:[]}))}this.fetchRuns(),this.props.query.runs&&this.fetchMetrics()},t.prototype.componentDidUpdate=function(e){this.props.query.experiments===e.query.experiments&&this.props.query.runFilters===e.query.runFilters&&this.props.query.listChildRuns===e.query.listChildRuns||this.fetchRuns(),this.props.query.runs!==e.query.runs&&(this.fetchMetrics(),this.props.query.metricName&&this.props.onRunQuery())},t.prototype.initByTargetRuns=function(){if(void 0!==this.props.datasource.targetRuns){var e={};this.props.datasource.targetRuns.forEach((function(t){void 0===e[t.experiment]&&(e[t.experiment]=t.experimentName)}));var t=Object.keys(e).map((function(t){return{label:e[t],value:t}})),r=this.props.datasource.targetRuns.map((function(e){return{label:e.label,experimentId:e.experiment,value:e.run}})),a=this.props,i=a.onChange,o=a.query;i(n.__assign(n.__assign({},o),{experiments:t,runs:r}))}},t.prototype.fetchRuns=function(){return n.__awaiter(this,void 0,Promise,(function(){var e=this;return n.__generator(this,(function(t){return this.setState({runs:void 0,metrics:[]},(function(){return n.__awaiter(e,void 0,void 0,(function(){var e,t,r,a,i;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,s.RunHistoryClient.fetchRunsFromIndexService(this.props.datasource,this.props.query)];case 1:return e=n.sent(),t=e.runs,r=e.continuationToken,a=this.props.query.runs||[],i=a.filter((function(e){return!t.some((function(t){return t.value===e.value}))})),this.setState({runs:t.concat(i),metrics:[],showRunCountWarning:!!r}),[2]}}))}))})),[2]}))}))},t.prototype.fetchMetrics=function(){return n.__awaiter(this,void 0,Promise,(function(){var e=this;return n.__generator(this,(function(t){return this.setState({metrics:void 0},(function(){return n.__awaiter(e,void 0,void 0,(function(){var e,t,r,i,o,u=this;return n.__generator(this,(function(l){switch(l.label){case 0:return e=this.props.query.runs||[],t={},e.forEach((function(e){void 0===t[e.experimentId]&&(t[e.experimentId]=[]),t[e.experimentId].push(e.value)})),r=Object.entries(t).map((function(e){var t=n.__read(e,2),r=t[0],a=t[1];return s.RunHistoryClient.fetchMetrics(u.props.datasource,u.props.query,r,a)})),[4,Promise.all(r)];case 1:return i=l.sent(),o=a.default.uniq(i.flat()).sort().map((function(e){return{label:e,value:e}})),this.setState({metrics:o}),[2]}}))}))})),[2]}))}))},t.prototype.loadFilteredExperiments=function(e){return n.__awaiter(this,void 0,Promise,(function(){var r,a,i,o=this;return n.__generator(this,(function(u){switch(u.label){case 0:return[4,s.RunHistoryClient.fetchExperiments(this.props.datasource,e)];case 1:return r=u.sent(),a=r.experiments,i=r.continuationToken,this.setState({showExperimentCountWarning:!!i,experiments:n.__spread(a)}),void 0===a||void 0!==this.props.query.experiments&&!a.some((function(e){return-1==o.props.query.experiments.indexOf(e.value)}))||a.unshift({label:l.SELECT_ALL_LABEL,value:t.allExperimentsKey}),[2,a]}}))}))},t.prototype.render=function(){var e=this.state.runs?n.__spread(this.state.runs):void 0;return void 0===e||0===e.length||void 0!==this.props.query.runs&&this.props.query.runs.length===e.length||e.unshift({label:l.SELECT_ALL_LABEL,value:t.allRunsKey,experimentId:"0"}),i.default.createElement("div",{className:"gf-form-group"},i.default.createElement(o.Label,{style:l.h2},"Filter Runs"),i.default.createElement("div",{className:"gf-form"},i.default.createElement("div",{className:"gf-form-inline",style:{width:300}},i.default.createElement("div",null,i.default.createElement(o.Checkbox,{label:"Filter by experiment",value:this.props.query.filterByExperiments,onChange:this.onFilterByExperimentsChange}),!0===this.props.query.filterByExperiments?i.default.createElement("div",{className:"gf-form-inline"},i.default.createElement(o.AsyncMultiSelect,{width:35,defaultOptions:!0,isClearable:!0,maxVisibleValues:2,cacheOptions:!1,loadOptions:this.loadFilteredExperiments,onChange:this.onExperimentSelected,placeholder:"Select experiment",value:this.props.query.experiments||[]}),this.state.showExperimentCountWarning?i.default.createElement("span",null,"Not all experiments can be shown. Type in dropdown to refine list."):i.default.createElement(i.default.Fragment,null)):i.default.createElement(i.default.Fragment,null)))),i.default.createElement(u.FilterControl,{filters:this.props.query.runFilters||[],includeChildRuns:this.props.query.listChildRuns,onFiltersUpdate:this.onFiltersUpdated,onChildRunsUpdate:this.onListChildRunsChange}),i.default.createElement("div",{className:"gf-form"},i.default.createElement("div",{className:"gf-form-inline",style:{width:300}},i.default.createElement(o.Label,{style:l.h3},"Runs"),i.default.createElement(o.Field,{invalid:this.state.showRunCountWarning,error:this.state.showRunCountWarning?"Refine filtering further. Too many runs to display.":void 0},i.default.createElement(o.MultiSelect,{width:35,isClearable:!0,maxVisibleValues:2,onChange:this.onRunSelected,options:e,placeholder:"Select run",value:this.props.query.runs,isLoading:void 0===this.state.runs}))),i.default.createElement("div",{className:"gf-form-inline",style:{width:300}},i.default.createElement(o.Label,{style:l.h3},"Metric"),i.default.createElement(o.Field,null,i.default.createElement(o.Select,{width:35,onChange:this.onMetricSelected,options:this.state.metrics,placeholder:"Select metric",value:this.props.query.metricName,isLoading:void 0===this.state.metrics,disabled:!this.state.metrics||0===this.state.metrics.length})))))},t.allExperimentsKey="AllExperiments",t.allRunsKey="AllRuns",t}(i.PureComponent);t.QueryEditor=c},function(e,t){e.exports=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilterControl=void 0;var n=r(0),a=n.__importDefault(r(2)),i=r(3),o=r(1),s=r(23),u=r(4),l=r(24),c=r(25),d=function(e){function t(t){var r=e.call(this,t)||this;return r.openEditor=function(){r.setState({editorOpen:!0})},r.closeEditor=function(){r.setState({editorOpen:!1,value:void 0,filterValidationError:void 0})},r.deleteFilter=function(e){var t=n.__spread(r.props.filters);t.splice(e,1),r.props.onFiltersUpdate(t)},r.setProperty=function(e){var t=u.propertyDetailsDict[e.value];r.setState({selectedProperty:e.value,operation:t.options[0]})},r.setOperation=function(e){r.setState({operation:e})},r.setSelectValue=function(e){r.setState({value:e.value})},r.setValue=function(e){r.setState({value:e.target.value,filterValidationError:void 0})},r.setAdditionalValue=function(e){r.setState({additionalValue:e.target.value})},r.onChildRunsChange=function(e){r.props.onChildRunsUpdate(e.currentTarget.checked)},r.onMoveTimePicker=function(e){var t=s.getShiftedTimeRange(e,r.state.timerangeValue),n=t.from,a=t.to,i={from:o.dateTimeForTimeZone("browser",n),to:o.dateTimeForTimeZone("browser",a),raw:r.state.timerangeValue.raw};r.setState({timerangeValue:i})},r.onZoom=function(){var e=s.getZoomedTimeRange(r.state.timerangeValue,2),t=e.from,n=e.to,a={from:o.dateTimeForTimeZone("browser",t),to:o.dateTimeForTimeZone("browser",n),raw:r.state.timerangeValue.raw};r.setState({timerangeValue:a})},r.validateAndSave=function(){var e={},t=u.propertyDetailsDict[r.state.selectedProperty];if(t.type===u.PropertyType.date)e.filterProps=[{field:t.queryPath,operator:u.FilterOperations.greaterOrEqual,values:[r.state.timerangeValue.from]},{field:t.queryPath,operator:u.FilterOperations.lessOrEqual,values:[r.state.timerangeValue.to]}],e.displayString=r.state.selectedProperty+": "+r.state.timerangeValue.from.toString()+" - "+r.state.timerangeValue.to.toString();else{if(void 0===r.state.value)return void r.setState({filterValidationError:"Value required"});switch(t.type){case u.PropertyType.number:e.filterProps=[{field:t.queryPath,operator:r.state.operation.value,values:[Number.parseFloat(r.state.value)]}],e.displayString=r.state.selectedProperty+" "+r.state.operation.label+" "+r.state.value;break;case u.PropertyType.tag:if(""===r.state.value){r.setState({filterValidationError:"Value required"});break}var n=r.state.operation.value===u.FilterOperations.equals?[r.state.additionalValue]:[null],a=r.state.operation.value===u.FilterOperations.equals?"== "+r.state.additionalValue:"is defined",i="Tags: "+r.state.value+" "+a;e.filterProps=[{field:t.queryPath+r.state.value,operator:r.state.operation.value,values:n}],e.displayString=i;break;default:case u.PropertyType.string:e.filterProps=[{field:t.queryPath,operator:r.state.operation.value,values:[r.state.value]}],e.displayString=r.state.selectedProperty+" "+r.state.operation.label+" "+r.state.value}}r.props.onFiltersUpdate(r.props.filters.concat(e))},r.state={editorOpen:!1,selectedProperty:u.RunProperties.number,operation:u.numericOperations[0],value:void 0,timerangeValue:{from:o.dateTime().subtract(6,"hours"),to:o.dateTime(),raw:{from:"now-6h",to:"now"}}},r}return n.__extends(t,e),t.prototype.getPropertyDetailsControl=function(e){return e.type===u.PropertyType.date?a.default.createElement(a.default.Fragment,null):a.default.createElement(l.SelectField,{value:this.state.value,onChange:this.setOperation,options:e.options,displayError:this.state.filterValidationError})},t.prototype.getValueInputControl=function(e){var t=this;switch(e.type){case u.PropertyType.number:return a.default.createElement(c.InputField,{inputType:"number",placeholderText:"value",value:this.state.value,onChange:this.setValue,displayError:this.state.filterValidationError});case u.PropertyType.tag:return a.default.createElement(a.default.Fragment,null,a.default.createElement(c.InputField,{inputType:"text",placeholderText:"key",value:this.state.value,onChange:this.setValue,displayError:this.state.filterValidationError}),this.state.operation.value===u.FilterOperations.equals?a.default.createElement(c.InputField,{inputType:"text",placeholderText:"value",value:this.state.additionalValue,onChange:this.setAdditionalValue,displayError:this.state.filterValidationError}):a.default.createElement(a.default.Fragment,null));case u.PropertyType.date:return a.default.createElement("div",{style:u.timePickerContainer},a.default.createElement("hr",{style:u.horizDivForTimePicker}),a.default.createElement("div",{style:u.timePicker},a.default.createElement(i.Label,{style:u.timePickerLabel},"Choose Time Range"),a.default.createElement(i.Field,{invalid:void 0!==this.state.filterValidationError,error:this.state.filterValidationError},a.default.createElement(i.TimeRangePicker,{timeZone:"browser",value:this.state.timerangeValue,onChange:function(e){t.setState({timerangeValue:e})},onMoveBackward:function(){return t.onMoveTimePicker(s.shiftDirections.Backward)},onMoveForward:function(){return t.onMoveTimePicker(s.shiftDirections.Forward)},onZoom:function(){return t.onZoom()}}))));default:case u.PropertyType.string:switch(this.state.selectedProperty){case u.RunProperties.runType:case u.RunProperties.status:return a.default.createElement(l.SelectField,{value:this.state.value,onChange:this.setSelectValue,options:e.allowedValues,displayError:this.state.filterValidationError});default:return a.default.createElement(c.InputField,{inputType:"text",placeholderText:"value",value:this.state.value,onChange:this.setValue,displayError:this.state.filterValidationError})}}},t.prototype.getAddFilter=function(){return a.default.createElement(i.Field,null,a.default.createElement(i.Button,{style:{marginBottom:"10px",marginTop:"8px"},className:"gf-form-inline",icon:"filter",onClick:this.openEditor},"Add filter"))},t.prototype.render=function(){var e=this,t=u.propertyDetailsDict[this.state.selectedProperty];return a.default.createElement(a.default.Fragment,null,this.state.editorOpen?a.default.createElement(a.default.Fragment,null,a.default.createElement(i.Label,{style:u.h3},"Add New Filter"),a.default.createElement("div",{className:"gf-form-inline"},a.default.createElement(l.SelectField,{value:this.state.selectedProperty,onChange:this.setProperty,options:u.propertiesOptions,displayError:this.state.filterValidationError}),this.getPropertyDetailsControl(t),this.getValueInputControl(t)),a.default.createElement("div",{className:"gf-form-inline",style:{marginBottom:"20px"}},a.default.createElement(i.Button,{style:{marginRight:"10px"},className:"gf-form-inline ",onClick:this.validateAndSave,icon:"plus"},"Save"),a.default.createElement(i.Button,{className:"gf-form-inline",onClick:this.closeEditor,icon:"times",variant:"destructive"},"Cancel"))):this.getAddFilter(),a.default.createElement(i.Label,{style:u.h2},"Run Filters"),a.default.createElement(i.Checkbox,{value:this.props.includeChildRuns,onChange:this.onChildRunsChange,label:"Include child runs in list"}),this.props.filters.map((function(t,r){return a.default.createElement(i.Button,{style:{margin:"0px 5px"},size:"sm",variant:"secondary",onClick:e.deleteFilter.bind(e,r),icon:"times"},t.displayString)})))},t}(a.default.PureComponent);t.FilterControl=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getZoomedTimeRange=t.getShiftedTimeRange=t.shiftDirections=void 0;var n,a=r(1);!function(e){e[e.Forward=0]="Forward",e[e.Backward=1]="Backward"}(n=t.shiftDirections||(t.shiftDirections={})),t.getShiftedTimeRange=function(e,t){var r,i,o={from:a.toUtc(t.from),to:a.toUtc(t.to)},s=(o.to.valueOf()-o.from.valueOf())/2;return e===n.Backward?(r=o.to.valueOf()-s,i=o.from.valueOf()-s):e===n.Forward?(r=o.to.valueOf()+s,i=o.from.valueOf()+s,r>Date.now()&&o.to.valueOf()<Date.now()&&(r=Date.now(),i=o.from.valueOf())):(r=o.to.valueOf(),i=o.from.valueOf()),{from:i,to:r}},t.getZoomedTimeRange=function(e,t){var r=e.to.valueOf()-e.from.valueOf(),n=e.to.valueOf()-r/2;return{from:n-r*t/2,to:n+r*t/2}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SelectField=void 0;var n=r(0).__importDefault(r(2)),a=r(3);t.SelectField=function(e){return n.default.createElement(a.Field,{className:"gf-form-inline width-10",invalid:void 0!==e.displayError,error:e.displayError},n.default.createElement(a.Select,{className:"width-9",options:e.options,value:e.value,onChange:e.onChange}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InputField=void 0;var n=r(0).__importDefault(r(2)),a=r(3);t.InputField=function(e){return n.default.createElement(a.Field,{className:"gf-form-inline width-10",invalid:void 0!==e.displayError,error:e.displayError},n.default.createElement(a.Input,{className:"width-9",placeholder:e.placeholderText,type:e.inputType,value:e.value,onChange:e.onChange}))}}])}));
//# sourceMappingURL=module.js.map